## **Описание проекта**

К вам в ужасе прибегает менеджер и сообщает, что витрина больше не собирается. Вы начинаете разбираться, в чем причина и выясняете, что разработчики бэкенда приложения обновили структуру данных в схеме production. Очень торопились выкатить релиз и в суматохе забыли предупредить вас об этом.

Разберемся, что именно было изменено. В таблице Orders больше нет поля статус. А это поле вам очень нужно, т.к. для задач аналитики вы берете только успешно выполненные заказы (завершенные статусом closed). Вместо поля с одним статусом разработчики добавили таблицу для журналирования всех изменений статусов заказов - `production.OrderStatusLog`.

Структура таблицы: 

- id - синтетический автогенерируемый идентификатор записи.
- order_id - идентификатор заказа, внешний слюч на таблицу `production.Orders`.
- status_id - идентификатор статуса, внешний ключ на таблицу статусов заказов - `production.OrderStatuses`.
- dttm - таймстемп, дата и время получения заказом этого статуса.

Для того, чтобы ваш скрипт по расчету витрины продолжил работать, вам необходимо внести изменения в то, как формируется представление (view) `analysis.Orders` - вам необходимо вделать так, чтобы в этом представлении по-прежнему присутствовало поле `status`. Значение в этом поле должно соответствовать последнему (по времени) значению статуса из таблицы `production.OrderStatusLog`.

Для проверки предоставьте код на языке SQL, выполняющий обновление представления `analysis.Orders`.

## Технические детали

Для действий над БД вы можете использовать любой из инструментов:
- Утилиту командной строки `psql`. Подключиться к нужной БД можно командой: `psql postgresql://jovyan:jovyan@localhost:5432/de`.
- Сервис DBeaver. Чтобы использовать его, перейдите по URI `/cloudbeaver/` и нажмите на кнопку `SQL` в верхнем меню. Тогда откроется страница для написания и выполнения запросов.
- - CloudBeaver иногда может перенаправить вас на адрес без порта, например, `http://localhost/cloudbeaver` вместо `http://localhost:3000/cloudbeaver`. Исправьте это, вручную дописав порт
- Metabase также позволяет выполнять произвольные запросы на чтение.

В контейнере запущена база данных *PostgreSQL*:
- логин: jovyan
- пароль: jovyan
- порт: 5432
- хост: изнутри контейнера localhost
- база данных: **de**

Вы можете протестировать свой запрос с помощью Python, командной строки и утилиты `psql`, Metabase (URI: `/metabase/`) или DBeaver (URI: `/cloudbeaver/`).
